#############################################
# è®¢é˜…å®šä¹‰ *æ— é¡»å…³æ³¨*
#############################################

proxy-providers:
  SSRDOG:
    url: "https://" # <--- è¯·åœ¨æ­¤å¡«å…¥æœºåœºAçš„è®¢é˜…é“¾æŽ¥
    type: http
    interval: 86400
    health-check: {enable: true, url: "https://www.gstatic.com/generate_204", interval: 300}
    override:
      additional-prefix: "[SSRDOG]"

  CroLAX:
    url: "https://" # <--- è¯·åœ¨æ­¤å¡«å…¥æœºåœºBçš„è®¢é˜…é“¾æŽ¥
    type: http
    interval: 86400
    health-check: {enable: true, url: "https://www.gstatic.com/generate_204", interval: 300}
    override:
      additional-prefix: "[CroLAX]"
proxies:
  - {name: "ç›´è¿ž", type: direct, udp: true}

#############################################
# åŸºç¡€å‚æ•° *é‡ç‚¹å…³æ³¨*
#############################################

mixed-port: 7890
ipv6: true
allow-lan: true
unified-delay: false
tcp-concurrent: true
bind-address: '*'
mode: rule
log-level: warning
find-process-mode: off # strict
global-client-fingerprint: chrome
profile:
  store-selected: true
  tracing: false
  store-fake-ip: true

# Zashboard ç½‘é¡µç®¡ç†
external-controller: '[::]:9090'
external-ui: ui
external-ui-name: Zashboard
external-ui-url: https://github.com/Zephyruso/zashboard/releases/latest/download/dist-cdn-fonts.zip
secret: "181818"
port: 8080
socks-port: 1080
redir-port: 7891
tproxy-port: 7892

# ç¡¬ä»¶ä¸ŽæŽ§åˆ¶é€‰é¡¹ (ä¿æŒåŽŸç‰ˆé…ç½®)
interface-name: eth0
disable-keep-alive: true
keep-alive-idle: 600
keep-alive-interval: 30

# å…¶ä»–
hosts:
  localhost.localhost: 127.0.0.1
geodata-mode: false
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 48

# GeoIP æ•°æ®åº“ (ç”¨äºŽ GeoIP è§„åˆ™) qWen æä¾›çš„
geodata-mode: true
geox-url:
  geoip: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat"
  geosite: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb"
# Nikki ä¸­æä¾›çš„ä»£ç†
# https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat #å…¨çƒæ•°æ®åº“
# https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat #ä»…åŒ…å«ä¸­å›½
# https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb
# https://gh-proxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat
# https://gh-proxy.com/https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb

#############################################
# å—…æŽ¢ *é‡ç‚¹å…³æ³¨*
#############################################

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  sniff:
    HTTP:
      port:
        - "80"
        - "8080"
      override-destination: true
    TLS:
      port:
        - "443"
        - "8443"
      override-destination: true
    QUIC:
      port:
        - "443"
        - "8443"
      override-destination: true
    # å¼ºåˆ¶è§£æžåŸŸå # GeminiåŠ çš„ï¼Œæˆ‘æ²¡çœ‹æ‡‚
    force-domain: 
      - "+.google.com"
  # skip-domain: # è·³è¿‡åŸŸå
  #   - "Mijia Cloud"
  #   - "+.push.apple.com"

#############################################
# å…¥ç«™ *é‡ç‚¹å…³æ³¨*
#############################################

tun:
  enable: true
  # ä½¿ç”¨ Nikki æ··å…¥å…¨éƒ¨ä¸ä¿®æ”¹çš„æƒ…å†µï¼Œå¼€å¯æŽ¥å£æŒ‡å®šä¸ºnikki
  device: nikki
  stack: system # mixed # ä¸çŽ©æ¸¸æˆç”¨ system æ›´ç¨³å¦¥
  mtu: 9000 #
  gso: true #
  gso-max-size: 65536 #
  # ä½¿ç”¨ä»…å†…æ ¸æ”¹ä¸‹é¢ä¸‰é¡¹ä¸º true # Gemini å»ºè®®å¼€å¯ä¸‹é¢ä¸‰é¡¹
  auto-route: false
  auto-redirect: false
  auto-detect-interface: false
  # åŠ«æŒDNSè¯·æ±‚
  # dns-hijack: 
  #   - "any:53"
  #   - "tcp://any:53"

#############################################
# DNS *é‡ç‚¹å…³æ³¨*
#############################################

dns:
  enable: true
  ipv6: true # false
  listen: '[::]:1053'
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  use-hosts: true # æŸ¥è¯¢ hosts
  cache-algorithm: arc
  fake-ip-filter:
    - +.lan
    - +.local
    - geosite:cn
    # - "+.market.xiaomi.com" # qWen æä¾›çš„
    # - "+.push.apple.com"
    # - "*.lan" # æ„Ÿè§‰æ²¡å¿…è¦ï¼Œå¥½åƒæ˜¯ç¤ºèŒƒ
    # - "*.localdomain"
    # - "*.example"
    # - "*.invalid"
    # - "*.localhost"
    # - "*.test"
    # - "*.home.arpa"

  fake-ip-filter-mode: blacklist
  respect-rules: true
  prefer-h3: false
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  proxy-server-nameserver:
    - 192.168.50.1
    - 223.5.5.5
  direct-nameserver:
    - 192.168.50.1
    - 223.5.5.5
  nameserver:
    - https://223.5.5.5/dns-query
    - https://8.8.8.8/dns-query
  # å¤‡ç”¨DNSï¼ˆä¸»DNSå¤±æ•ˆæ—¶å…œåº•ï¼‰
  fallback:
    - https://8.8.8.8/dns-query
    - https://1.1.1.1/dns-query
  # ä¸ƒå°ºå®‡çš„fake-ip-filterï¼Œéœ€è¦é…åˆè‡ªå»ºçš„è§„åˆ™
  fake-ip-filter:
    - "rule-set:fakeipfilter_domain"

#############################################
# ç­–ç•¥ç»„ *æ— é¡»å…³æ³¨*
#############################################

proxy-groups:
  - name: é»˜è®¤
    type: select
    proxies: [è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹]

  - name: Google
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: Telegram
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: Twitter
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: å“”å“©å“”å“©
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: å·´å“ˆå§†ç‰¹
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: YouTube
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: NETFLIX
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: Spotify
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: Github
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  - name: å›½å†…
    type: select
    proxies: [ç›´è¿ž, é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©]

  - name: å…¶ä»–
    type: select
    proxies: [é»˜è®¤, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾Žå›½, éŸ©å›½, è‹±å›½, å¾·å›½, æ³•å›½, è·å…°, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿ž]

  # åœ°åŒºåˆ†ç»„
  - name: é¦™æ¸¯
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)æ¸¯|hk|hongkong|hong kong"

  - name: å°æ¹¾
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)å°|tw|taiwan"

  - name: æ—¥æœ¬
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)æ—¥|jp|japan"

  - name: æ–°åŠ å¡
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)æ–°|sg|singapore"

  - name: ç¾Žå›½
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)ç¾Ž|us|unitedstates|united states"

  - name: éŸ©å›½
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)éŸ©|kr|korea|south korea"
  
  - name: è‹±å›½
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)è‹±|uk|great britain|united kingdom"

  - name: å¾·å›½
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)å¾·|de|germany"
  
  - name: æ³•å›½
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)æ³•|fr|france"

  - name: è·å…°
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)è·|nl|netherlands"

  - name: å…¶å®ƒåœ°åŒº
    type: select
    include-all: true
    exclude-type: direct
    # æŽ’é™¤æ‰€æœ‰å·²çŸ¥åœ°åŒºçš„å…³é”®è¯
    filter: "(?i)^(?!.*(?:ðŸ‡­ðŸ‡°|ðŸ‡¯ðŸ‡µ|ðŸ‡ºðŸ‡¸|ðŸ‡¸ðŸ‡¬|ðŸ‡¨ðŸ‡³|ðŸ‡¬ðŸ‡§|ðŸ‡©ðŸ‡ª|ðŸ‡«ðŸ‡·|ðŸ‡³ðŸ‡±|ðŸ‡°ðŸ‡·|æ¸¯|hk|hongkong|å°|tw|taiwan|æ—¥|jp|japan|æ–°|sg|singapore|ç¾Ž|us|unitedstates|éŸ©|kr|korea|è‹±|uk|britain|kingdom|å¾·|de|germany|æ³•|fr|france|è·|nl|netherlands)).*"

  - name: å…¨éƒ¨èŠ‚ç‚¹
    type: select
    include-all: true
    exclude-type: direct

  - name: è‡ªåŠ¨é€‰æ‹©
    type: url-test
    include-all: true
    exclude-type: direct
    tolerance: 10

#############################################
# è§„åˆ™é›† *æ— é¡»å…³æ³¨* æ·»åŠ äº†ä¸€ä¸ªä¸ƒå°ºå®‡çš„ fake-ip-filter
#############################################

rule-anchor:
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
rule-providers:
  # ä¸ƒå°ºå®‡é…åˆfake-ip-filterè‡ªå»ºçš„è§„åˆ™
  fakeipfilter_domain: {<<: *domain, url: "https://raw.githubusercontent.com/wwqgtxx/clash-rules/release/fakeip-filter.mrs"}
  private_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs"
  cn_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"
  biliintl_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/biliintl.mrs"
  ehentai_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ehentai.mrs"
  github_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs"
  twitter_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/twitter.mrs"
  youtube_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"
  google_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs"
  telegram_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"
  netflix_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs"
  bilibili_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bilibili.mrs"
  bahamut_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bahamut.mrs"
  spotify_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/spotify.mrs"
  pixiv_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/pixiv.mrs"
  geolocation-!cn:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs"

  private_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/private.mrs"
  cn_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs"
  google_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs"
  netflix_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs"
  twitter_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/twitter.mrs"
  telegram_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs"

#############################################
# åˆ†æµè§„åˆ™ *æ— é¡»å…³æ³¨*
#############################################

rules:
  - RULE-SET,private_ip,ç›´è¿ž,no-resolve
  - RULE-SET,github_domain,Github
  - RULE-SET,twitter_domain,Twitter
  - RULE-SET,youtube_domain,YouTube
  - RULE-SET,google_domain,Google
  - RULE-SET,telegram_domain,Telegram
  - RULE-SET,netflix_domain,NETFLIX
  - RULE-SET,bilibili_domain,å“”å“©å“”å“©
  - RULE-SET,bahamut_domain,å·´å“ˆå§†ç‰¹
  - RULE-SET,spotify_domain,Spotify
  - RULE-SET,cn_domain,å›½å†…
  - RULE-SET,geolocation-!cn,å…¶ä»–

  - RULE-SET,google_ip,Google
  - RULE-SET,netflix_ip,NETFLIX
  - RULE-SET,telegram_ip,Telegram
  - RULE-SET,twitter_ip,Twitter
  - RULE-SET,cn_ip,å›½å†…
  - MATCH,å…¶ä»–
